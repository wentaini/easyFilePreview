# EasyFilePreview

ä¸€ä¸ªå¼ºå¤§çš„æ–‡ä»¶é¢„è§ˆç³»ç»Ÿï¼Œæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼çš„åœ¨çº¿é¢„è§ˆï¼ŒåŒ…æ‹¬PDFã€Officeæ–‡æ¡£ã€å›¾ç‰‡ã€æ–‡æœ¬æ–‡ä»¶ç­‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ“„ æ–‡ä»¶é¢„è§ˆ
- **PDFæ–‡ä»¶**: åœ¨çº¿é¢„è§ˆï¼Œæ”¯æŒç¼©æ”¾ã€ç¿»é¡µ
- **Officeæ–‡æ¡£**: Wordã€Excelã€PowerPointæ–‡æ¡£é¢„è§ˆ
- **å›¾ç‰‡æ–‡ä»¶**: JPGã€PNGã€GIFç­‰æ ¼å¼é¢„è§ˆ
- **æ–‡æœ¬æ–‡ä»¶**: TXTã€MDã€XMLã€CSVç­‰æ ¼å¼é¢„è§ˆ
- **ä»£ç æ–‡ä»¶**: è¯­æ³•é«˜äº®æ˜¾ç¤º

### ğŸ” PDFæ–‡æœ¬æå–
- **æ–‡æœ¬æå–**: ä»PDFæ–‡ä»¶ä¸­æå–çº¯æ–‡æœ¬å†…å®¹
- **åˆ†é¡µå¤„ç†**: æ™ºèƒ½åˆ†å‰²PDFé¡µé¢ï¼Œè¿”å›æ¯é¡µçš„æ–‡æœ¬å†…å®¹
- **Markdownè½¬æ¢**: è‡ªåŠ¨å°†æ–‡æœ¬è½¬æ¢ä¸ºMarkdownæ ¼å¼
- **é€šç”¨è¡¨æ ¼è¯†åˆ«**: æ™ºèƒ½è¯†åˆ«å’Œè½¬æ¢å„ç§è¡¨æ ¼æ ¼å¼

### ğŸ¨ ç”¨æˆ·ç•Œé¢
- **å“åº”å¼è®¾è®¡**: æ”¯æŒPCã€å¹³æ¿ã€æ‰‹æœºç­‰è®¾å¤‡
- **ç°ä»£åŒ–UI**: ä½¿ç”¨Tailwind CSSæ„å»ºçš„ç¾è§‚ç•Œé¢
- **äº¤äº’å‹å¥½**: ç›´è§‚çš„æ“ä½œä½“éªŒ

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 16+
- npm æˆ– cnpm

### å®‰è£…ä¾èµ–
```bash
npm install
# æˆ–ä½¿ç”¨cnpm
cnpm install
```

### å¯åŠ¨æœåŠ¡
```bash
node index.js
```

æœåŠ¡å°†åœ¨ `http://localhost:3000` å¯åŠ¨

## APIæ–‡æ¡£

### æ–‡ä»¶é¢„è§ˆAPI

#### GET /api/filePreview
è·å–æ–‡ä»¶é¢„è§ˆä¿¡æ¯

**å‚æ•°:**
- `url`: æ–‡ä»¶URLåœ°å€

**ç¤ºä¾‹:**
```bash
GET /api/filePreview?url=https://example.com/document.pdf
```

### PDFæ–‡æœ¬æå–API

#### GET /api/filePreview/pdfText
ä»PDFæ–‡ä»¶ä¸­æå–æ–‡æœ¬å†…å®¹

**å‚æ•°:**
- `url`: PDFæ–‡ä»¶URLåœ°å€

**ç¤ºä¾‹:**
```bash
GET /api/filePreview/pdfText?url=https://example.com/document.pdf
```

**å“åº”æ ¼å¼:**
```json
{
  "success": true,
  "data": {
    "text": "å®Œæ•´çš„PDFæ–‡æœ¬å†…å®¹",
    "markdown": "è½¬æ¢ä¸ºMarkdownæ ¼å¼çš„å†…å®¹",
    "pages": [
      {
        "pageNumber": 1,
        "text": "ç¬¬1é¡µçš„æ–‡æœ¬å†…å®¹"
      }
    ],
    "markdownPages": [
      {
        "pageNumber": 1,
        "markdown": "ç¬¬1é¡µçš„Markdownå†…å®¹"
      }
    ]
  }
}
```

## é€šç”¨è¡¨æ ¼è¯†åˆ«åŠŸèƒ½

ç³»ç»Ÿæ”¯æŒæ™ºèƒ½è¯†åˆ«å’Œè½¬æ¢å¤šç§è¡¨æ ¼æ ¼å¼ï¼š

### æ”¯æŒçš„è¡¨æ ¼ç±»å‹

1. **æ ‡å‡†è¡¨æ ¼æ ¼å¼**
   ```
   å§“å  å¹´é¾„  èŒä¸š  åŸå¸‚
   å¼ ä¸‰  25   å·¥ç¨‹å¸ˆ  åŒ—äº¬
   æå››  30   è®¾è®¡å¸ˆ  ä¸Šæµ·
   ```

2. **é”®å€¼å¯¹æ ¼å¼**
   ```
   å§“å: å¼ ä¸‰
   å¹´é¾„: 25
   èŒä¸š: å·¥ç¨‹å¸ˆ
   ```

3. **å¯¹é½åˆ—æ ¼å¼**
   ```
   äº§å“åç§°    ä»·æ ¼    åº“å­˜    çŠ¶æ€
   è‹¹æœæ‰‹æœº    6999    100     æœ‰è´§
   åä¸ºå¹³æ¿    3999    50      ç¼ºè´§
   ```

4. **å•è¡Œè¡¨æ ¼æ ¼å¼**
   ```
   åºå· äº§å“ ä»·æ ¼ åº“å­˜ 1 è‹¹æœ 6999 100 2 åä¸º 3999 50
   ```

### è¡¨æ ¼è½¬æ¢ç¤ºä¾‹

**è¾“å…¥ï¼ˆé”®å€¼å¯¹æ ¼å¼ï¼‰ï¼š**
```
æˆ·å: å¼ ä¸‰
è´¦å·: 1234567890123456
é‡‘é¢: Â¥1000.00
```

**è¾“å‡ºï¼ˆMarkdownè¡¨æ ¼ï¼‰ï¼š**
```markdown
| å­—æ®µ | å€¼ |
| --- | --- |
| æˆ·å | å¼ ä¸‰ |
| è´¦å· | 1234567890123456 |
| é‡‘é¢ | Â¥1000.00 |
```

### æŠ€æœ¯ç‰¹ç‚¹

- **é€šç”¨æ€§**: ä¸ä¾èµ–ç‰¹å®šæ–‡æ¡£æ ¼å¼ï¼Œæ”¯æŒå¤šç§è¡¨æ ¼ç»“æ„
- **å‡†ç¡®æ€§**: åŸºäºæ ¼å¼ç‰¹å¾è€Œéå†…å®¹å…³é”®è¯ï¼Œé¿å…è¯¯åˆ¤
- **çµæ´»æ€§**: æ”¯æŒå•è¡Œå’Œå¤šè¡Œè¡¨æ ¼ï¼Œä¸åŒåˆ†éš”ç¬¦
- **å¯æ‰©å±•æ€§**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ·»åŠ æ–°çš„è¡¨æ ¼ç±»å‹

## é¡¹ç›®ç»“æ„

```
easyfilePreview/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ public/           # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ css/         # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ js/          # JavaScriptæ–‡ä»¶
â”‚   â”‚   â””â”€â”€ demoDoc/     # ç¤ºä¾‹æ–‡æ¡£
â”‚   â”œâ”€â”€ router.js        # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ filePreview.js           # æ–‡ä»¶é¢„è§ˆæ ¸å¿ƒé€»è¾‘
â”‚       â”œâ”€â”€ filePreviewHandler.js    # é¢„è§ˆå¤„ç†å™¨
â”‚       â””â”€â”€ excelImageExtractor.js   # Excelå›¾ç‰‡æå–
â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                # æ–‡æ¡£
â”œâ”€â”€ scripts/             # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ index.js             # åº”ç”¨å…¥å£
â””â”€â”€ package.json         # é¡¹ç›®é…ç½®
```

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- **Tailwind CSS**: ç°ä»£åŒ–CSSæ¡†æ¶
- **Vue.js**: æ¸è¿›å¼JavaScriptæ¡†æ¶
- **Chart.js**: å›¾è¡¨åº“
- **Marked**: Markdownè§£æå™¨

### åç«¯
- **Node.js**: JavaScriptè¿è¡Œæ—¶
- **Express**: Webåº”ç”¨æ¡†æ¶
- **pdf-parse**: PDFè§£æåº“
- **mammoth**: Wordæ–‡æ¡£è§£æ
- **xlsx**: Excelæ–‡ä»¶å¤„ç†

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
å¤åˆ¶ `env.example` ä¸º `.env` å¹¶é…ç½®ï¼š

```bash
# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# æ–‡ä»¶ç¼“å­˜é…ç½®
CACHE_DURATION=3600000
MAX_FILE_SIZE=52428800
```

### æ–‡ä»¶æ ¼å¼æ”¯æŒ

| æ ¼å¼ | æ‰©å±•å | é¢„è§ˆæ–¹å¼ |
|------|--------|----------|
| PDF | .pdf | åœ¨çº¿é¢„è§ˆ |
| Word | .doc, .docx | è½¬æ¢ä¸ºHTML |
| Excel | .xls, .xlsx | è½¬æ¢ä¸ºHTML |
| PowerPoint | .ppt, .pptx | è½¬æ¢ä¸ºHTML |
| å›¾ç‰‡ | .jpg, .jpeg, .png, .gif | ç›´æ¥æ˜¾ç¤º |
| æ–‡æœ¬ | .txt, .md, .xml, .csv | è¯­æ³•é«˜äº® |

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬é¢„è§ˆ
```javascript
// è·å–æ–‡ä»¶é¢„è§ˆä¿¡æ¯
const response = await fetch('/api/filePreview?url=https://example.com/document.pdf');
const data = await response.json();

if (data.success) {
    console.log('é¢„è§ˆURL:', data.data.previewUrl);
    console.log('æ–‡ä»¶ç±»å‹:', data.data.type);
}
```

### PDFæ–‡æœ¬æå–
```javascript
// æå–PDFæ–‡æœ¬
const response = await fetch('/api/filePreview/pdfText?url=https://example.com/document.pdf');
const data = await response.json();

if (data.success) {
    // æ£€æŸ¥æ˜¯å¦åŒ…å«è¡¨æ ¼
    const hasTable = data.data.markdown.includes('|');
    
    if (hasTable) {
        console.log('PDFåŒ…å«è¡¨æ ¼æ•°æ®');
        console.log('Markdownè¡¨æ ¼:', data.data.markdown);
    }
    
    // åˆ†é¡µå¤„ç†
    data.data.markdownPages.forEach(page => {
        const hasTable = page.markdown.includes('|');
        if (hasTable) {
            console.log(`ç¬¬${page.pageNumber}é¡µåŒ…å«è¡¨æ ¼`);
        }
    });
}
```

## éƒ¨ç½²

### Dockeréƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t easyfilepreview .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 easyfilepreview
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨PM2ç®¡ç†è¿›ç¨‹
npm install -g pm2
pm2 start index.js --name easyfilepreview

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

## å¼€å‘

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ESLint + Prettier
- éµå¾ªNode.jsé¡¹ç›®ç›®å½•è§„èŒƒ
- ä½¿ç”¨async/awaité¿å…å›è°ƒåœ°ç‹±

### æµ‹è¯•
```bash
# è¿è¡Œæµ‹è¯•
npm test

# ä»£ç æ£€æŸ¥
npm run lint
```

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

### å¼€å‘æµç¨‹
1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»ºPull Request

## è®¸å¯è¯

MIT License

## æ›´æ–°æ—¥å¿—

### v1.1.0
- âœ¨ æ·»åŠ é€šç”¨è¡¨æ ¼è¯†åˆ«åŠŸèƒ½
- âœ¨ æ”¯æŒå¤šç§è¡¨æ ¼ç±»å‹è½¬æ¢
- ğŸ”§ æ”¹è¿›è¡¨æ ¼æ£€æµ‹ç®—æ³•
- ğŸ› ä¿®å¤å ä½ç¬¦ä¿æŠ¤æœºåˆ¶
- ğŸ“š å®Œå–„APIæ–‡æ¡£

### v1.0.0
- ğŸ‰ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ¨ åŸºç¡€æ–‡ä»¶é¢„è§ˆåŠŸèƒ½
- âœ¨ PDFæ–‡æœ¬æå–åŠŸèƒ½
- âœ¨ Markdownè½¬æ¢åŠŸèƒ½
- ğŸ“± å“åº”å¼ç•Œé¢è®¾è®¡

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤Issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚ 